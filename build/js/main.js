!function t(i,e,n){function s(r,c){if(!e[r]){if(!i[r]){var h="function"==typeof require&&require;if(!c&&h)return h(r,!0);if(o)return o(r,!0);var p=new Error("Cannot find module '"+r+"'");throw p.code="MODULE_NOT_FOUND",p}var a=e[r]={exports:{}};i[r][0].call(a.exports,function(t){var e=i[r][1][t];return s(e?e:t)},a,a.exports,t,i,e,n)}return e[r].exports}for(var o="function"==typeof require&&require,r=0;r<n.length;r++)s(n[r]);return s}({1:[function(t,i,e){var n=function(t,i){this.entity=t,this.radius=i,this.type="circle"};n.prototype.collidesWith=function(t){return"circle"==t.components.collision.type?this.collideCircle(t):"rect"==t.components.collision.type?this.collideRect(t):!1},n.prototype.collideCircle=function(t){var i=this.entity.components.physics.position,e=t.components.physics.position,n=this.radius,s=t.components.collision.radius,o={x:i.x-e.x,y:i.y-e.y},r=o.x*o.x+o.y*o.y,c=n+s;return c*c>r},n.prototype.collideRect=function(t){var i=function(t,i,e){return i>t?i:t>e?e:t},e=this.entity.components.physics.position,n=t.components.physics.position,s=t.components.collision.size,o={x:i(e.x,n.x-s.x/2,n.x+s.x/2),y:i(e.y,n.y-s.y/2,n.y+s.y/2)},r=this.radius,c={x:e.x-o.x,y:e.y-o.y},h=c.x*c.x+c.y*c.y;return r*r>h},e.CircleCollisionComponent=n},{}],2:[function(t,i,e){var n=function(t,i){this.entity=t,this.size=i,this.type="rect"};n.prototype.collidesWith=function(t){return"circle"==t.components.collision.type?this.collideCircle(t):"rect"==t.components.collision.type?this.collideRect(t):!1},n.prototype.collideCircle=function(t){return t.components.collision.collideRect(this.entity)},n.prototype.collideRect=function(t){var i=this.entity.components.physics.position,e=t.components.physics.position,n=this.size,s=t.components.collision.size,o=i.x-n.x/2,r=i.x+n.x/2,c=i.y-n.y/2,h=i.y+n.y/2,p=e.x-s.x/2,a=e.x+s.x/2,l=e.y-s.y/2,u=e.y+s.y/2;return!(o>a||p>r||c>u||l>h)},e.RectCollisionComponent=n},{}],3:[function(t,i,e){var n=function(t,i){this.entity=t,this.size=i,this.type="rect"};n.prototype.collidesWith=function(t){return"circle"==t.components.collision.type?this.collideCircle(t):!1},n.prototype.collideCircle=function(t){return t.components.collision.collideRect(this.entity)},e.TopBottomCollisionComponent=n},{}],4:[function(t,i,e){var n=function(t){this.entity=t,this.backgroundImage=new Image,this.backgroundImage.src="./images/photobackground.jpeg"};n.prototype.draw=function(t){var i=this.entity.components.physics.position;t.save(),t.translate(i.x,i.y),t.scale(1,-1),t.drawImage(this.backgroundImage,0,0,this.backgroundImage.width,this.backgroundImage.height,-this.entity.width/2,-.5,this.entity.width,this.entity.height),t.restore()},e.BackgroundGraphicsComponent=n},{}],5:[function(t,i,e){var n=function(t){this.entity=t};n.prototype.draw=function(t){var i=this.entity.components.physics.position;t.save(),t.fillStyle="green",t.translate(i.x,i.y),t.beginPath(),t.arc(0,0,.02,0,2*Math.PI),t.fill(),t.closePath(),t.restore()},e.BirdGraphicsComponent=n},{}],6:[function(t,i,e){var n=function(t,i){this.entity=t,this.size=i};n.prototype.draw=function(t){var i=this.entity.components.physics.position;t.save(),t.beginPath(),t.translate(i.x,i.y),t.rect(-this.size.x/2,-this.size.y/2,this.size.x,this.size.y),t.fill(),t.closePath(),t.restore()},e.PipeGraphicsComponent=n},{}],7:[function(t,i,e){var n=function(t,i){this.entity=t,this.size=i};n.prototype.draw=function(t){this.entity.components.physics.position;t.save(),t.beginPath(),t.rect(-this.size.x/2,-this.size.y/2,this.size.x,this.size.y),t.fill(),t.closePath(),t.restore()},e.TopGraphicsComponent=n},{}],8:[function(t,i,e){var n=function(t){this.entity=t,this.position={x:0,y:0},this.velocity={x:0,y:0},this.acceleration={x:0,y:0}};n.prototype.update=function(t){this.velocity.x+=this.acceleration.x*t,this.velocity.y+=this.acceleration.y*t,this.position.x+=this.velocity.x*t,this.position.y+=this.velocity.y*t},e.PhysicsComponent=n},{}],9:[function(t,i,e){var n=t("../components/physics/physics"),s=t("../components/graphics/background"),o=function(t,i,e,o){var r=new n.PhysicsComponent(this);r.position.x=t,r.position.y=i,r.velocity.x=-.2,this.width=e,this.height=o;var c=s.BackgroundGraphicsComponent(this);this.components={physics:r,graphics:c}};e.background=o},{"../components/graphics/background":4,"../components/physics/physics":8}],10:[function(t,i,e){var n=t("../components/physics/physics"),s=t("../components/graphics/bird"),o=t("../components/collision/circle"),r=(t("../flappy_bird"),t("../entities/pipe")),c=t("../entities/top"),h=function(t){this.eventEmits=t;var i=new n.PhysicsComponent(this);i.position.y=.5,i.acceleration.y=-2;var e=new s.BirdGraphicsComponent(this),r=new o.CircleCollisionComponent(this,.02);r.onCollision=this.onCollision.bind(this),this.components={physics:i,graphics:e,collision:r}};h.prototype.onCollision=function(t){(t instanceof r.Pipe||t instanceof c.Top)&&(this.eventEmits.emit("crash"),this.reset())},h.prototype.reset=function(){this.components.physics.position.y=.5},e.Bird=h},{"../components/collision/circle":1,"../components/graphics/bird":5,"../components/physics/physics":8,"../entities/pipe":11,"../entities/top":12,"../flappy_bird":13}],11:[function(t,i,e){var n=t("../components/graphics/pipe"),s=t("../components/physics/physics"),o=t("../components/collision/rect"),r=function(t,i){var e=new s.PhysicsComponent(this);e.position=t,e.velocity.x=-.5;var r=new n.PipeGraphicsComponent(this,i),c=new o.RectCollisionComponent(this,i);c.onCollision=this.onCollision.bind(this),this.components={physics:e,graphics:r,collision:c}};r.prototype.onCollision=function(t){console.log("Pipe collided with entity:",t)},e.Pipe=r},{"../components/collision/rect":2,"../components/graphics/pipe":6,"../components/physics/physics":8}],12:[function(t,i,e){var n=t("../components/graphics/top"),s=t("../components/physics/physics"),o=t("../components/collision/topbottom"),r=function(t,i){var e=new s.PhysicsComponent(this);e.position=t,e.velocity.x=0;var r=new n.TopGraphicsComponent(this,i),c=new o.TopBottomCollisionComponent(this,i);c.onCollision=this.onCollision.bind(this),this.components={physics:e,graphics:r,collision:c}};r.prototype.onCollision=function(t){console.log("top collided with entity:",t)},e.Top=r},{"../components/collision/topbottom":3,"../components/graphics/top":7,"../components/physics/physics":8}],13:[function(t,i,e){var n=t("./systems/graphics"),s=t("./systems/physics"),o=t("./systems/input"),r=t("./systems/makepipes"),c=t("./systems/maketop"),h=t("./systems/background"),p=t("events").EventEmitter,a=t("./entities/bird"),l=(t("./entities/pipe"),t("./entities/top"),function(){this.eventEmits=new p,this.entities=[new a.Bird(this.eventEmits)],this.graphics=new n.GraphicsSystem(this.entities,this.eventEmits),this.physics=new s.PhysicsSystem(this.entities,this.eventEmits),this.inputs=new o.InputSystem(this.entities,this.eventEmits),this.pipes=new r.MakePipes(this.entities,this.eventEmits),this.tops=new c.MakeTop(this.entities,this.eventEmits),this.backgrounds=new h.BackgroundSystem(this.entities,this.eventEmits)});l.prototype.run=function(){this.graphics.run(),this.physics.run(),this.inputs.run(),this.pipes.run(),this.tops.run(),this.backgrounds.run()},l.prototype.reset=function(){this.entities=[new a.Bird]},e.FlappyBird=l},{"./entities/bird":10,"./entities/pipe":11,"./entities/top":12,"./systems/background":15,"./systems/graphics":17,"./systems/input":18,"./systems/makepipes":19,"./systems/maketop":20,"./systems/physics":21,events:22}],14:[function(t,i,e){var n=t("./flappy_bird");document.addEventListener("DOMContentLoaded",function(){var t=new n.FlappyBird;console.log(n),t.run()})},{"./flappy_bird":13}],15:[function(t,i,e){var n=t("../entities/background"),s=function(t,i){this.bus=i,this.entities=t,this.backgrounds=[],this.setup()};s.prototype.setup=function(){var t=window.innerWidth/window.innerHeight,i=window.innerHeight/window.innerHeight,e=(window.innerWidth-2)/window.innerHeight,s=new n.background(0,i/2,t,i),o=new n.background(e,i/2,t,i);this.backgrounds.push(s,o),this.entities.unshift(s,o)},s.prototype.reposition=function(){for(var t=0;t<this.entities.length;t++){var i=this.entities[t],e=(window.innerWidth-2)/window.innerHeight;i instanceof n.background&&i.components.physics.position.x<-e&&(i.components.physics.position.x=e)}},s.prototype.run=function(){window.setInterval(this.reposition.bind(this),1e3/60)},e.BackgroundSystem=s},{"../entities/background":9}],16:[function(t,i,e){var n=function(t){this.entities=t};n.prototype.tick=function(){for(var t=0;t<this.entities.length;t++){var i=this.entities[t];if(!(!1 in i.components))for(var e=t+1;e<this.entities.length;e++){var n=this.entities[e];!1 in n.components||i.components.collision.collidesWith(n)&&(i.components.collision.onCollision&&i.components.collision.onCollision(n),n.components.collision.onCollision&&n.components.collision.onCollision(i))}}},e.CollisionSystem=n},{}],17:[function(t,i,e){var n=function(t){this.entities=t,this.canvas=document.getElementById("main-canvas"),this.context=this.canvas.getContext("2d")};n.prototype.run=function(){window.requestAnimationFrame(this.tick.bind(this))},n.prototype.tick=function(){(this.canvas.width!=this.canvas.offsetWidth||this.canvas.height!=this.canvas.offsetHeight)&&(this.canvas.width=this.canvas.offsetWidth,this.canvas.height=this.canvas.offsetHeight),this.context.clearRect(0,0,this.canvas.width,this.canvas.height),this.context.save(),this.context.translate(this.canvas.width/2,this.canvas.height),this.context.scale(this.canvas.height,-this.canvas.height);for(var t=0;t<this.entities.length;t++){var i=this.entities[t];!1 in i.components||i.components.graphics.draw(this.context)}this.context.restore(),window.requestAnimationFrame(this.tick.bind(this))},e.GraphicsSystem=n},{}],18:[function(t,i,e){var n=function(t){this.entities=t,this.canvas=document.getElementById("main-canvas")};n.prototype.run=function(){this.canvas.addEventListener("click",this.onClick.bind(this))},n.prototype.onClick=function(){var t=this.entities[0];t.components.physics.velocity.y=.6},e.InputSystem=n},{}],19:[function(t,i,e){var n=t("../entities/pipe"),s=function(t,i){this.entities=t,this.canvas=document.getElementById("main-canvas"),this.interval=null,this.eventEmits=i,this.eventEmits.on("crash",this.removePipes.bind(this))};s.prototype.run=function(){this.interval=window.setInterval(this.tick.bind(this),2e3)},s.prototype.tick=function(){var t=.5*this.canvas.width/this.canvas.height,i=.4+.2*Math.random(),e=i-.1,s={x:t+.075,y:e/2},o={x:.15,y:e};this.entities.push(new n.Pipe(s,o));var e=1-i-.1,s={x:t+.075,y:1-e/2},o={x:.15,y:e};this.entities.push(new n.Pipe(s,o))},s.prototype.removePipes=function(){for(var t=this.entities.length-1;t>=0;t--){var i=this.entities[t];i instanceof n.Pipe&&this.entities.splice(t,1)}console.log("removing pipes")},e.MakePipes=s},{"../entities/pipe":11}],20:[function(t,i,e){var n=t("../entities/top"),s=function(t,i){this.entities=t,this.canvas=document.getElementById("main-canvas"),this.interval=null,this.eventEmits=i,this.eventEmits.on("crash",this.removeTop.bind(this))};s.prototype.run=function(){var t=.5*this.canvas.width/this.canvas.height,i=.5,e=i-.5,s={x:t+.075,y:e/2},o={x:3,y:e};this.entities.push(new n.Top(s,o));var e=1-i-.5,s={x:t+.075,y:1-e/2},o={x:3,y:e};this.entities.push(new n.Top(s,o))},s.prototype.removeTop=function(){for(var t=this.entities.length-1;t>=0;t--){var i=this.entities[t];i instanceof n.Top&&this.entities.splice(t,1)}console.log("removing pipes"),this.run()},e.MakeTop=s},{"../entities/top":12}],21:[function(t,i,e){var n=t("./collision"),s=function(t){this.entities=t,this.collisionSystem=new n.CollisionSystem(t)};s.prototype.run=function(){window.setInterval(this.tick.bind(this),1e3/60)},s.prototype.tick=function(){for(var t=0;t<this.entities.length;t++){var i=this.entities[t];!1 in i.components||i.components.physics.update(1/60)}this.collisionSystem.tick()},e.PhysicsSystem=s},{"./collision":16}],22:[function(t,i,e){function n(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function s(t){return"function"==typeof t}function o(t){return"number"==typeof t}function r(t){return"object"==typeof t&&null!==t}function c(t){return void 0===t}i.exports=n,n.EventEmitter=n,n.prototype._events=void 0,n.prototype._maxListeners=void 0,n.defaultMaxListeners=10,n.prototype.setMaxListeners=function(t){if(!o(t)||0>t||isNaN(t))throw TypeError("n must be a positive number");return this._maxListeners=t,this},n.prototype.emit=function(t){var i,e,n,o,h,p;if(this._events||(this._events={}),"error"===t&&(!this._events.error||r(this._events.error)&&!this._events.error.length)){if(i=arguments[1],i instanceof Error)throw i;throw TypeError('Uncaught, unspecified "error" event.')}if(e=this._events[t],c(e))return!1;if(s(e))switch(arguments.length){case 1:e.call(this);break;case 2:e.call(this,arguments[1]);break;case 3:e.call(this,arguments[1],arguments[2]);break;default:o=Array.prototype.slice.call(arguments,1),e.apply(this,o)}else if(r(e))for(o=Array.prototype.slice.call(arguments,1),p=e.slice(),n=p.length,h=0;n>h;h++)p[h].apply(this,o);return!0},n.prototype.addListener=function(t,i){var e;if(!s(i))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",t,s(i.listener)?i.listener:i),this._events[t]?r(this._events[t])?this._events[t].push(i):this._events[t]=[this._events[t],i]:this._events[t]=i,r(this._events[t])&&!this._events[t].warned&&(e=c(this._maxListeners)?n.defaultMaxListeners:this._maxListeners,e&&e>0&&this._events[t].length>e&&(this._events[t].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[t].length),"function"==typeof console.trace&&console.trace())),this},n.prototype.on=n.prototype.addListener,n.prototype.once=function(t,i){function e(){this.removeListener(t,e),n||(n=!0,i.apply(this,arguments))}if(!s(i))throw TypeError("listener must be a function");var n=!1;return e.listener=i,this.on(t,e),this},n.prototype.removeListener=function(t,i){var e,n,o,c;if(!s(i))throw TypeError("listener must be a function");if(!this._events||!this._events[t])return this;if(e=this._events[t],o=e.length,n=-1,e===i||s(e.listener)&&e.listener===i)delete this._events[t],this._events.removeListener&&this.emit("removeListener",t,i);else if(r(e)){for(c=o;c-->0;)if(e[c]===i||e[c].listener&&e[c].listener===i){n=c;break}if(0>n)return this;1===e.length?(e.length=0,delete this._events[t]):e.splice(n,1),this._events.removeListener&&this.emit("removeListener",t,i)}return this},n.prototype.removeAllListeners=function(t){var i,e;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[t]&&delete this._events[t],this;if(0===arguments.length){for(i in this._events)"removeListener"!==i&&this.removeAllListeners(i);return this.removeAllListeners("removeListener"),this._events={},this}if(e=this._events[t],s(e))this.removeListener(t,e);else if(e)for(;e.length;)this.removeListener(t,e[e.length-1]);return delete this._events[t],this},n.prototype.listeners=function(t){var i;return i=this._events&&this._events[t]?s(this._events[t])?[this._events[t]]:this._events[t].slice():[]},n.prototype.listenerCount=function(t){if(this._events){var i=this._events[t];if(s(i))return 1;if(i)return i.length}return 0},n.listenerCount=function(t,i){return t.listenerCount(i)}},{}]},{},[14]);